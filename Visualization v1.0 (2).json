{"paragraphs":[{"text":"val countryDataText = sc.textFile(\"/home/app/data/national_count_data.csv\")\r\n\r\ncase class CountryData(year: Integer, month: Integer, game:Integer, golf : Integer, tour : Integer, karaoke : Integer, billard : Integer, hospital : Integer, video : Integer, entertainment: Integer, restaurant: Integer, press: Integer, orientalclinic: Integer, gym: Integer, total: Integer)\r\n\r\n// split each line, and map it into CountryData case class  \r\nval countryData = countryDataText.map(s=>s.split(\",\")).map(\r\n    s=>CountryData(s(0).replaceAll(\"\\\"\", \"\").split(\"-\")(0).toInt, \r\n            s(0).replaceAll(\"\\\"\", \"\").split(\"-\")(1).toInt, \r\n            s(1).toInt,\r\n            s(2).toInt,\r\n            s(3).toInt,\r\n            s(4).toInt,\r\n            s(5).toInt,\r\n            s(6).toInt,\r\n            s(7).toInt,\r\n            s(8).toInt,\r\n            s(9).toInt,\r\n            s(10).toInt,\r\n            s(11).toInt,\r\n            s(12).toInt,\r\n            s(13).toInt\r\n        )\r\n)\r\n\r\n// convert to DataFrame and create temporal table\r\nval countryDataDF = countryData.toDF()\r\ncountryDataDF.show()\r\ncountryDataDF.registerTempTable(\"countryData\")","dateUpdated":"Mar 22, 2016 4:54:39 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","lineNumbers":true,"tableHide":true,"editorHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458622194014_967681449","id":"20160322-044954_741052678","result":{"code":"SUCCESS","type":"TEXT","msg":"countryDataText: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[1] at textFile at <console>:29\ndefined class CountryData\ncountryData: org.apache.spark.rdd.RDD[CountryData] = MapPartitionsRDD[3] at map at <console>:35\ncountryDataDF: org.apache.spark.sql.DataFrame = [year: int, month: int, game: int, golf: int, tour: int, karaoke: int, billard: int, hospital: int, video: int, entertainment: int, restaurant: int, press: int, orientalclinic: int, gym: int, total: int]\n+----+-----+----+----+----+-------+-------+--------+-----+-------------+----------+-----+--------------+---+------+\n|year|month|game|golf|tour|karaoke|billard|hospital|video|entertainment|restaurant|press|orientalclinic|gym| total|\n+----+-----+----+----+----+-------+-------+--------+-----+-------------+----------+-----+--------------+---+------+\n|2000|    1| 302|  17|  44|    105|    123|     143|   15|          340|      4974|  107|             2| 32|  6204|\n|2000|    2| 628|  37|  96|    181|    239|     300|   22|          658|     10428|  196|             5| 69| 12859|\n|2000|    3|1049|  52| 185|    296|    392|     501|   40|         1044|     17723|  286|             7|114| 21689|\n|2000|    4|1341|  79| 234|    385|    536|     712|   49|         1318|     23171|  361|            12|135| 28333|\n|2000|    5|1628|  92| 280|    494|    640|     867|   56|         1630|     28926|  444|            15|170| 35242|\n|2000|    6|1855| 102| 343|    565|    721|    1002|   63|         1999|     34451|  524|            19|199| 41843|\n|2000|    7|2059| 114| 384|    651|    819|    1110|   78|         2322|     39486|  615|            20|230| 47888|\n|2000|    8|2268| 130| 433|    733|    895|    1210|   85|         2596|     44545|  686|            20|253| 53854|\n|2000|    9|2425| 139| 480|    796|    951|    1325|   98|         2864|     49009|  750|            21|280| 59138|\n|2000|   10|2548| 153| 537|    863|   1035|    1447|  119|         3158|     54830|  814|            21|321| 65846|\n|2000|   11|2674| 176| 588|    949|   1090|    1579|  134|         3494|     60556|  882|            21|352| 72495|\n|2000|   12|2761| 197| 645|   1088|   1142|    1725|  146|         3918|     66089|  953|            21|378| 79063|\n|2001|    1|2848| 216| 702|   1146|   1193|    1877|  159|         4157|     68928| 1026|            22|401| 82675|\n|2001|    2|2963| 235| 739|   1236|   1287|    2078|  168|         4387|     73210| 1121|            22|439| 87885|\n|2001|    3|3136| 253| 793|   1350|   1404|    2334|  179|         4700|     79430| 1210|            23|482| 95294|\n|2001|    4|3274| 274| 856|   1452|   1501|    2601|  199|         5010|     85976| 1314|            26|516|102999|\n|2001|    5|3342| 290| 934|   1566|   1595|    2818|  215|         5314|     92740| 1406|            27|559|110806|\n|2001|    6|3420| 308| 996|   1674|   1690|    2997|  235|         5670|     99366| 1492|            28|601|118477|\n|2001|    7|3482| 332|1062|   1769|   1764|    3152|  257|         6007|    105566| 1564|            28|648|125631|\n|2001|    8|3509| 365|1134|   1867|   1811|    3343|  291|         6325|    111566| 1642|            31|677|132561|\n+----+-----+----+----+----+-------+-------+--------+-----+-------------+----------+-----+--------------+---+------+\nonly showing top 20 rows\n\n"},"dateCreated":"Mar 22, 2016 4:49:54 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:20","dateFinished":"Mar 22, 2016 4:54:20 AM","dateStarted":"Mar 22, 2016 4:54:15 AM","focus":true},{"text":"%sql select year, sum(${3sector=total,total|game|golf|tour|karaoke|billard|hospital|video|entertainment|restaurant|press|orientalclinic|gym}) NumberOfCompanies from countryData where   year >= ${1minYear=2000} and year <= ${2maxYear=2014} group by year order by year","dateUpdated":"Mar 22, 2016 4:54:48 AM","config":{"colWidth":6,"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"year","index":0,"aggr":"sum"}],"values":[{"name":"NumberOfCompanies","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"year","index":0,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql","editorHide":true,"tableHide":false},"settings":{"params":{"maxYear":"2014","sector":"game","1minYear":"2000","2maxYear":"2014","3sector":"total"},"forms":{"3sector":{"name":"3sector","defaultValue":"total","options":[{"value":"total"},{"value":"game"},{"value":"golf"},{"value":"tour"},{"value":"karaoke"},{"value":"billard"},{"value":"hospital"},{"value":"video"},{"value":"entertainment"},{"value":"restaurant"},{"value":"press"},{"value":"orientalclinic"},{"value":"gym"}],"hidden":false},"2maxYear":{"name":"2maxYear","defaultValue":"2014","hidden":false},"1minYear":{"name":"1minYear","defaultValue":"2000","hidden":false}}},"jobName":"paragraph_1458622194017_952676242","id":"20160322-044954_725158312","result":{"code":"SUCCESS","type":"TABLE","msg":"year\tNumberOfCompanies\n2000\t524454\n2001\t1462032\n2002\t2398124\n2003\t3095627\n2004\t3589644\n2005\t3915115\n2006\t4141173\n2007\t4348010\n2008\t4632694\n2009\t4886984\n2010\t5155555\n2011\t5413317\n2012\t5609628\n2013\t5762289\n2014\t5945558\n","comment":"","msgTable":[[{"key":"NumberOfCompanies","value":"2000"},{"key":"NumberOfCompanies","value":"524454"}],[{"value":"2001"},{"value":"1462032"}],[{"value":"2002"},{"value":"2398124"}],[{"value":"2003"},{"value":"3095627"}],[{"value":"2004"},{"value":"3589644"}],[{"value":"2005"},{"value":"3915115"}],[{"value":"2006"},{"value":"4141173"}],[{"value":"2007"},{"value":"4348010"}],[{"value":"2008"},{"value":"4632694"}],[{"value":"2009"},{"value":"4886984"}],[{"value":"2010"},{"value":"5155555"}],[{"value":"2011"},{"value":"5413317"}],[{"value":"2012"},{"value":"5609628"}],[{"value":"2013"},{"value":"5762289"}],[{"value":"2014"},{"value":"5945558"}]],"columnNames":[{"name":"year","index":0,"aggr":"sum"},{"name":"NumberOfCompanies","index":1,"aggr":"sum"}],"rows":[["2000","524454"],["2001","1462032"],["2002","2398124"],["2003","3095627"],["2004","3589644"],["2005","3915115"],["2006","4141173"],["2007","4348010"],["2008","4632694"],["2009","4886984"],["2010","5155555"],["2011","5413317"],["2012","5609628"],["2013","5762289"],["2014","5945558"]]},"dateCreated":"Mar 22, 2016 4:49:54 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:21","dateFinished":"Mar 22, 2016 4:54:51 AM","dateStarted":"Mar 22, 2016 4:54:48 AM","focus":true},{"text":"%sql select year, sum(${3compared_sector=total,total|game|golf|tour|karaoke|billard|hospital|video|entertainment|restaurant|press|orientalclinic|gym}) NumberOfCompanies from countryData where  year >= ${1minYear=2000} and year <= ${2maxYear=2014} group by year order by year","dateUpdated":"Mar 22, 2016 4:54:55 AM","config":{"colWidth":6,"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"year","index":0,"aggr":"sum"}],"values":[{"name":"NumberOfCompanies","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"year","index":0,"aggr":"sum"},"yAxis":{"name":"NumberOfCompanies","index":1,"aggr":"sum"}}},"enabled":true},"settings":{"params":{"sector":"golf","1minYear":"2000","2maxYear":"2014","3sector":"game","3compared_sector":"game"},"forms":{"3compared_sector":{"name":"3compared_sector","defaultValue":"total","options":[{"value":"total"},{"value":"game"},{"value":"golf"},{"value":"tour"},{"value":"karaoke"},{"value":"billard"},{"value":"hospital"},{"value":"video"},{"value":"entertainment"},{"value":"restaurant"},{"value":"press"},{"value":"orientalclinic"},{"value":"gym"}],"hidden":false},"2maxYear":{"name":"2maxYear","defaultValue":"2014","hidden":false},"1minYear":{"name":"1minYear","defaultValue":"2000","hidden":false}}},"jobName":"paragraph_1458622194017_952676242","id":"20160322-044954_1495971241","result":{"code":"SUCCESS","type":"TABLE","msg":"year\tNumberOfCompanies\n2000\t21538\n2001\t44796\n2002\t97224\n2003\t115499\n2004\t131989\n2005\t153463\n2006\t168139\n2007\t135343\n2008\t158973\n2009\t161318\n2010\t148168\n2011\t133941\n2012\t105903\n2013\t78099\n2014\t40223\n","comment":"","msgTable":[[{"key":"NumberOfCompanies","value":"2000"},{"key":"NumberOfCompanies","value":"21538"}],[{"value":"2001"},{"value":"44796"}],[{"value":"2002"},{"value":"97224"}],[{"value":"2003"},{"value":"115499"}],[{"value":"2004"},{"value":"131989"}],[{"value":"2005"},{"value":"153463"}],[{"value":"2006"},{"value":"168139"}],[{"value":"2007"},{"value":"135343"}],[{"value":"2008"},{"value":"158973"}],[{"value":"2009"},{"value":"161318"}],[{"value":"2010"},{"value":"148168"}],[{"value":"2011"},{"value":"133941"}],[{"value":"2012"},{"value":"105903"}],[{"value":"2013"},{"value":"78099"}],[{"value":"2014"},{"value":"40223"}]],"columnNames":[{"name":"year","index":0,"aggr":"sum"},{"name":"NumberOfCompanies","index":1,"aggr":"sum"}],"rows":[["2000","21538"],["2001","44796"],["2002","97224"],["2003","115499"],["2004","131989"],["2005","153463"],["2006","168139"],["2007","135343"],["2008","158973"],["2009","161318"],["2010","148168"],["2011","133941"],["2012","105903"],["2013","78099"],["2014","40223"]]},"dateCreated":"Mar 22, 2016 4:49:54 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:22","dateFinished":"Mar 22, 2016 4:54:56 AM","dateStarted":"Mar 22, 2016 4:54:55 AM","focus":true},{"text":"%sql select month, year, sum(${2sector=total,total|game|golf|tour|karaoke|billard|hospital|video|entertainment|restaurant|press|orientalclinic|gym}) Sector, \nsum(${3compared_sector=total,total|game|golf|tour|karaoke|billard|hospital|video|entertainment|restaurant|press|orientalclinic|gym}) ComparedSector from countryData \nwhere  year <= ${1year=2014} and year >= ${1year=2014} and month >= 1 and month <= 12 group by month, year order by month","dateUpdated":"Mar 22, 2016 4:55:02 AM","config":{"colWidth":12,"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"month","index":0,"aggr":"sum"}],"values":[{"name":"Sector","index":2,"aggr":"sum"},{"name":"ComparedSector","index":3,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"month","index":0,"aggr":"sum"},"yAxis":{"name":"year","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql","editorHide":true,"tableHide":false},"settings":{"params":{"year":"2000","sector":"game","1year":"2010","compare_sector":"tour","2sector":"game","3compare_sector":"golf","3compared_sector":"golf"},"forms":{"3compared_sector":{"name":"3compared_sector","defaultValue":"total","options":[{"value":"total"},{"value":"game"},{"value":"golf"},{"value":"tour"},{"value":"karaoke"},{"value":"billard"},{"value":"hospital"},{"value":"video"},{"value":"entertainment"},{"value":"restaurant"},{"value":"press"},{"value":"orientalclinic"},{"value":"gym"}],"hidden":false},"1year":{"name":"1year","defaultValue":"2014","hidden":false},"2sector":{"name":"2sector","defaultValue":"total","options":[{"value":"total"},{"value":"game"},{"value":"golf"},{"value":"tour"},{"value":"karaoke"},{"value":"billard"},{"value":"hospital"},{"value":"video"},{"value":"entertainment"},{"value":"restaurant"},{"value":"press"},{"value":"orientalclinic"},{"value":"gym"}],"hidden":false}}},"jobName":"paragraph_1458622194018_953830488","id":"20160322-044954_2104668218","result":{"code":"SUCCESS","type":"TABLE","msg":"month\tyear\tSector\tComparedSector\n1\t2010\t12858\t4937\n2\t2010\t12764\t4988\n3\t2010\t12705\t5074\n4\t2010\t12568\t5162\n5\t2010\t12409\t5248\n6\t2010\t12290\t5343\n7\t2010\t12232\t5427\n8\t2010\t12165\t5485\n9\t2010\t12113\t5521\n10\t2010\t12053\t5577\n11\t2010\t12027\t5664\n12\t2010\t11984\t5715\n","comment":"","msgTable":[[{"key":"year","value":"1"},{"key":"year","value":"2010"},{"key":"year","value":"12858"},{"key":"year","value":"4937"}],[{"key":"Sector","value":"2"},{"key":"Sector","value":"2010"},{"key":"Sector","value":"12764"},{"key":"Sector","value":"4988"}],[{"key":"ComparedSector","value":"3"},{"key":"ComparedSector","value":"2010"},{"key":"ComparedSector","value":"12705"},{"key":"ComparedSector","value":"5074"}],[{"value":"4"},{"value":"2010"},{"value":"12568"},{"value":"5162"}],[{"value":"5"},{"value":"2010"},{"value":"12409"},{"value":"5248"}],[{"value":"6"},{"value":"2010"},{"value":"12290"},{"value":"5343"}],[{"value":"7"},{"value":"2010"},{"value":"12232"},{"value":"5427"}],[{"value":"8"},{"value":"2010"},{"value":"12165"},{"value":"5485"}],[{"value":"9"},{"value":"2010"},{"value":"12113"},{"value":"5521"}],[{"value":"10"},{"value":"2010"},{"value":"12053"},{"value":"5577"}],[{"value":"11"},{"value":"2010"},{"value":"12027"},{"value":"5664"}],[{"value":"12"},{"value":"2010"},{"value":"11984"},{"value":"5715"}]],"columnNames":[{"name":"month","index":0,"aggr":"sum"},{"name":"year","index":1,"aggr":"sum"},{"name":"Sector","index":2,"aggr":"sum"},{"name":"ComparedSector","index":3,"aggr":"sum"}],"rows":[["1","2010","12858","4937"],["2","2010","12764","4988"],["3","2010","12705","5074"],["4","2010","12568","5162"],["5","2010","12409","5248"],["6","2010","12290","5343"],["7","2010","12232","5427"],["8","2010","12165","5485"],["9","2010","12113","5521"],["10","2010","12053","5577"],["11","2010","12027","5664"],["12","2010","11984","5715"]]},"dateCreated":"Mar 22, 2016 4:49:54 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:23","dateFinished":"Mar 22, 2016 4:55:02 AM","dateStarted":"Mar 22, 2016 4:55:02 AM","focus":true},{"text":"%sql select sum(game) game, sum(golf) golf, sum(tour) tour, sum(karaoke) karaoke, sum(billard) billard, sum(hospital) hospital, sum(video) video, \nsum(entertainment) entertainment, sum(restaurant) restaurant, sum(press) press, sum(orientalclinic) orientalclinic, sum(gym) gym, year\nfrom countryData where  year = ${year=2014} and 1=1 group by year, month","dateUpdated":"Mar 22, 2016 4:55:09 AM","config":{"colWidth":12,"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"year","index":12,"aggr":"sum"}],"values":[{"name":"game","index":0,"aggr":"sum"},{"name":"golf","index":1,"aggr":"sum"},{"name":"tour","index":2,"aggr":"sum"},{"name":"karaoke","index":3,"aggr":"sum"},{"name":"billard","index":4,"aggr":"sum"},{"name":"hospital","index":5,"aggr":"sum"},{"name":"press","index":9,"aggr":"sum"},{"name":"orientalclinic","index":10,"aggr":"sum"},{"name":"gym","index":11,"aggr":"sum"},{"name":"entertainment","index":7,"aggr":"sum"},{"name":"video","index":6,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"game","index":0,"aggr":"sum"},"yAxis":{"name":"golf","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql","editorHide":false,"tableHide":false},"settings":{"params":{"year":"2013"},"forms":{"year":{"name":"year","defaultValue":"2014","hidden":false}}},"jobName":"paragraph_1458622194018_953830488","id":"20160322-044954_1469440496","result":{"code":"SUCCESS","type":"TABLE","msg":"game\tgolf\ttour\tkaraoke\tbillard\thospital\tvideo\tentertainment\trestaurant\tpress\torientalclinic\tgym\tyear\n7627\t6706\t9464\t2204\t13265\t26511\t151\t19758\t381026\t3945\t323\t3315\t2013\n7443\t6706\t9489\t2131\t13200\t26606\t140\t19768\t381317\t3823\t324\t3333\t2013\n7270\t6732\t9556\t2063\t13161\t26733\t137\t19805\t383064\t3716\t324\t3349\t2013\n7023\t6757\t9616\t1992\t13124\t26964\t132\t19812\t385026\t3600\t324\t3363\t2013\n6830\t6757\t9647\t1926\t13069\t27077\t129\t19798\t386441\t3505\t330\t3375\t2013\n6587\t6778\t9679\t1861\t13027\t27184\t127\t19756\t387159\t3434\t334\t3390\t2013\n6439\t6794\t9743\t1788\t12970\t27290\t123\t19775\t388895\t3341\t333\t3405\t2013\n6239\t6802\t9768\t1679\t12896\t27373\t118\t19771\t390133\t3256\t337\t3431\t2013\n5996\t6799\t9783\t1561\t12867\t27484\t111\t19770\t390749\t3167\t339\t3443\t2013\n5833\t6821\t9862\t1511\t12855\t27613\t107\t19793\t393191\t3099\t338\t3471\t2013\n5532\t6823\t9900\t1439\t12834\t27678\t98\t19830\t394695\t3024\t341\t3487\t2013\n5280\t6843\t9930\t1362\t12782\t27757\t95\t19870\t396217\t2936\t338\t3518\t2013\n","comment":"","msgTable":[[{"key":"golf","value":"7627"},{"key":"golf","value":"6706"},{"key":"golf","value":"9464"},{"key":"golf","value":"2204"},{"key":"golf","value":"13265"},{"key":"golf","value":"26511"},{"key":"golf","value":"151"},{"key":"golf","value":"19758"},{"key":"golf","value":"381026"},{"key":"golf","value":"3945"},{"key":"golf","value":"323"},{"key":"golf","value":"3315"},{"key":"golf","value":"2013"}],[{"key":"tour","value":"7443"},{"key":"tour","value":"6706"},{"key":"tour","value":"9489"},{"key":"tour","value":"2131"},{"key":"tour","value":"13200"},{"key":"tour","value":"26606"},{"key":"tour","value":"140"},{"key":"tour","value":"19768"},{"key":"tour","value":"381317"},{"key":"tour","value":"3823"},{"key":"tour","value":"324"},{"key":"tour","value":"3333"},{"key":"tour","value":"2013"}],[{"key":"karaoke","value":"7270"},{"key":"karaoke","value":"6732"},{"key":"karaoke","value":"9556"},{"key":"karaoke","value":"2063"},{"key":"karaoke","value":"13161"},{"key":"karaoke","value":"26733"},{"key":"karaoke","value":"137"},{"key":"karaoke","value":"19805"},{"key":"karaoke","value":"383064"},{"key":"karaoke","value":"3716"},{"key":"karaoke","value":"324"},{"key":"karaoke","value":"3349"},{"key":"karaoke","value":"2013"}],[{"key":"billard","value":"7023"},{"key":"billard","value":"6757"},{"key":"billard","value":"9616"},{"key":"billard","value":"1992"},{"key":"billard","value":"13124"},{"key":"billard","value":"26964"},{"key":"billard","value":"132"},{"key":"billard","value":"19812"},{"key":"billard","value":"385026"},{"key":"billard","value":"3600"},{"key":"billard","value":"324"},{"key":"billard","value":"3363"},{"key":"billard","value":"2013"}],[{"key":"hospital","value":"6830"},{"key":"hospital","value":"6757"},{"key":"hospital","value":"9647"},{"key":"hospital","value":"1926"},{"key":"hospital","value":"13069"},{"key":"hospital","value":"27077"},{"key":"hospital","value":"129"},{"key":"hospital","value":"19798"},{"key":"hospital","value":"386441"},{"key":"hospital","value":"3505"},{"key":"hospital","value":"330"},{"key":"hospital","value":"3375"},{"key":"hospital","value":"2013"}],[{"key":"video","value":"6587"},{"key":"video","value":"6778"},{"key":"video","value":"9679"},{"key":"video","value":"1861"},{"key":"video","value":"13027"},{"key":"video","value":"27184"},{"key":"video","value":"127"},{"key":"video","value":"19756"},{"key":"video","value":"387159"},{"key":"video","value":"3434"},{"key":"video","value":"334"},{"key":"video","value":"3390"},{"key":"video","value":"2013"}],[{"key":"entertainment","value":"6439"},{"key":"entertainment","value":"6794"},{"key":"entertainment","value":"9743"},{"key":"entertainment","value":"1788"},{"key":"entertainment","value":"12970"},{"key":"entertainment","value":"27290"},{"key":"entertainment","value":"123"},{"key":"entertainment","value":"19775"},{"key":"entertainment","value":"388895"},{"key":"entertainment","value":"3341"},{"key":"entertainment","value":"333"},{"key":"entertainment","value":"3405"},{"key":"entertainment","value":"2013"}],[{"key":"restaurant","value":"6239"},{"key":"restaurant","value":"6802"},{"key":"restaurant","value":"9768"},{"key":"restaurant","value":"1679"},{"key":"restaurant","value":"12896"},{"key":"restaurant","value":"27373"},{"key":"restaurant","value":"118"},{"key":"restaurant","value":"19771"},{"key":"restaurant","value":"390133"},{"key":"restaurant","value":"3256"},{"key":"restaurant","value":"337"},{"key":"restaurant","value":"3431"},{"key":"restaurant","value":"2013"}],[{"key":"press","value":"5996"},{"key":"press","value":"6799"},{"key":"press","value":"9783"},{"key":"press","value":"1561"},{"key":"press","value":"12867"},{"key":"press","value":"27484"},{"key":"press","value":"111"},{"key":"press","value":"19770"},{"key":"press","value":"390749"},{"key":"press","value":"3167"},{"key":"press","value":"339"},{"key":"press","value":"3443"},{"key":"press","value":"2013"}],[{"key":"orientalclinic","value":"5833"},{"key":"orientalclinic","value":"6821"},{"key":"orientalclinic","value":"9862"},{"key":"orientalclinic","value":"1511"},{"key":"orientalclinic","value":"12855"},{"key":"orientalclinic","value":"27613"},{"key":"orientalclinic","value":"107"},{"key":"orientalclinic","value":"19793"},{"key":"orientalclinic","value":"393191"},{"key":"orientalclinic","value":"3099"},{"key":"orientalclinic","value":"338"},{"key":"orientalclinic","value":"3471"},{"key":"orientalclinic","value":"2013"}],[{"key":"gym","value":"5532"},{"key":"gym","value":"6823"},{"key":"gym","value":"9900"},{"key":"gym","value":"1439"},{"key":"gym","value":"12834"},{"key":"gym","value":"27678"},{"key":"gym","value":"98"},{"key":"gym","value":"19830"},{"key":"gym","value":"394695"},{"key":"gym","value":"3024"},{"key":"gym","value":"341"},{"key":"gym","value":"3487"},{"key":"gym","value":"2013"}],[{"key":"year","value":"5280"},{"key":"year","value":"6843"},{"key":"year","value":"9930"},{"key":"year","value":"1362"},{"key":"year","value":"12782"},{"key":"year","value":"27757"},{"key":"year","value":"95"},{"key":"year","value":"19870"},{"key":"year","value":"396217"},{"key":"year","value":"2936"},{"key":"year","value":"338"},{"key":"year","value":"3518"},{"key":"year","value":"2013"}]],"columnNames":[{"name":"game","index":0,"aggr":"sum"},{"name":"golf","index":1,"aggr":"sum"},{"name":"tour","index":2,"aggr":"sum"},{"name":"karaoke","index":3,"aggr":"sum"},{"name":"billard","index":4,"aggr":"sum"},{"name":"hospital","index":5,"aggr":"sum"},{"name":"video","index":6,"aggr":"sum"},{"name":"entertainment","index":7,"aggr":"sum"},{"name":"restaurant","index":8,"aggr":"sum"},{"name":"press","index":9,"aggr":"sum"},{"name":"orientalclinic","index":10,"aggr":"sum"},{"name":"gym","index":11,"aggr":"sum"},{"name":"year","index":12,"aggr":"sum"}],"rows":[["7627","6706","9464","2204","13265","26511","151","19758","381026","3945","323","3315","2013"],["7443","6706","9489","2131","13200","26606","140","19768","381317","3823","324","3333","2013"],["7270","6732","9556","2063","13161","26733","137","19805","383064","3716","324","3349","2013"],["7023","6757","9616","1992","13124","26964","132","19812","385026","3600","324","3363","2013"],["6830","6757","9647","1926","13069","27077","129","19798","386441","3505","330","3375","2013"],["6587","6778","9679","1861","13027","27184","127","19756","387159","3434","334","3390","2013"],["6439","6794","9743","1788","12970","27290","123","19775","388895","3341","333","3405","2013"],["6239","6802","9768","1679","12896","27373","118","19771","390133","3256","337","3431","2013"],["5996","6799","9783","1561","12867","27484","111","19770","390749","3167","339","3443","2013"],["5833","6821","9862","1511","12855","27613","107","19793","393191","3099","338","3471","2013"],["5532","6823","9900","1439","12834","27678","98","19830","394695","3024","341","3487","2013"],["5280","6843","9930","1362","12782","27757","95","19870","396217","2936","338","3518","2013"]]},"dateCreated":"Mar 22, 2016 4:49:54 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:24","dateFinished":"Mar 22, 2016 4:55:10 AM","dateStarted":"Mar 22, 2016 4:55:09 AM","focus":true},{"text":"%sql select sum(game) game, sum(golf) golf, sum(tour) tour, sum(karaoke) karaoke, sum(billard) billard, sum(hospital) hospital, sum(video) video, \nsum(entertainment) entertainment, sum(restaurant) restaurant, sum(press) press, sum(orientalclinic) orientalclinic, sum(gym) gym, year, month\nfrom countryData where year = ${2year=2014} and month = ${1month=1} group by year, month","dateUpdated":"Mar 22, 2016 4:55:14 AM","config":{"colWidth":12,"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"month","index":13,"aggr":"sum"}],"values":[{"name":"game","index":0,"aggr":"sum"},{"name":"golf","index":1,"aggr":"sum"},{"name":"tour","index":2,"aggr":"sum"},{"name":"karaoke","index":3,"aggr":"sum"},{"name":"billard","index":4,"aggr":"sum"},{"name":"hospital","index":5,"aggr":"sum"},{"name":"press","index":9,"aggr":"sum"},{"name":"orientalclinic","index":10,"aggr":"sum"},{"name":"gym","index":11,"aggr":"sum"},{"name":"entertainment","index":7,"aggr":"sum"},{"name":"video","index":6,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"game","index":0,"aggr":"sum"},"yAxis":{"name":"golf","index":1,"aggr":"sum"}}},"enabled":true,"editorHide":true,"tableHide":false,"editorMode":"ace/mode/sql"},"settings":{"params":{"month":"3","year":"2010","1year":"2014","2month":"1","1month":"12","2year":"2014"},"forms":{"2year":{"name":"2year","defaultValue":"2014","hidden":false},"1month":{"name":"1month","defaultValue":"1","hidden":false}}},"jobName":"paragraph_1458622194018_953830488","id":"20160322-044954_872601315","result":{"code":"SUCCESS","type":"TABLE","msg":"game\tgolf\ttour\tkaraoke\tbillard\thospital\tvideo\tentertainment\trestaurant\tpress\torientalclinic\tgym\tyear\tmonth\n1900\t6954\t10462\t598\t12432\t28694\t36\t19988\t419285\t1322\t361\t3865\t2014\t12\n","comment":"","msgTable":[[{"key":"golf","value":"1900"},{"key":"golf","value":"6954"},{"key":"golf","value":"10462"},{"key":"golf","value":"598"},{"key":"golf","value":"12432"},{"key":"golf","value":"28694"},{"key":"golf","value":"36"},{"key":"golf","value":"19988"},{"key":"golf","value":"419285"},{"key":"golf","value":"1322"},{"key":"golf","value":"361"},{"key":"golf","value":"3865"},{"key":"golf","value":"2014"},{"key":"golf","value":"12"}]],"columnNames":[{"name":"game","index":0,"aggr":"sum"},{"name":"golf","index":1,"aggr":"sum"},{"name":"tour","index":2,"aggr":"sum"},{"name":"karaoke","index":3,"aggr":"sum"},{"name":"billard","index":4,"aggr":"sum"},{"name":"hospital","index":5,"aggr":"sum"},{"name":"video","index":6,"aggr":"sum"},{"name":"entertainment","index":7,"aggr":"sum"},{"name":"restaurant","index":8,"aggr":"sum"},{"name":"press","index":9,"aggr":"sum"},{"name":"orientalclinic","index":10,"aggr":"sum"},{"name":"gym","index":11,"aggr":"sum"},{"name":"year","index":12,"aggr":"sum"},{"name":"month","index":13,"aggr":"sum"}],"rows":[["1900","6954","10462","598","12432","28694","36","19988","419285","1322","361","3865","2014","12"]]},"dateCreated":"Mar 22, 2016 4:49:54 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25","dateFinished":"Mar 22, 2016 4:55:15 AM","dateStarted":"Mar 22, 2016 4:55:14 AM","focus":true},{"text":"val interpreterContext = z.getInterpreterContext()\nz.angularBind(\"inputYear\", Array(2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014))\nz.angularBind(\"year\", 2014)\nz.angularUnwatch(\"year\")\nz.angularWatch(\"year\", (before, after) => {\n    z.run(8, interpreterContext)\n})","dateUpdated":"Mar 22, 2016 4:50:17 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458622194018_953830488","id":"20160322-044954_948550199","result":{"code":"SUCCESS","type":"TEXT","msg":"interpreterContext: org.apache.zeppelin.interpreter.InterpreterContext = org.apache.zeppelin.interpreter.InterpreterContext@643547ce\n"},"dateCreated":"Mar 22, 2016 4:49:54 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:26","dateFinished":"Mar 22, 2016 4:51:41 AM","dateStarted":"Mar 22, 2016 4:50:17 AM","focus":true},{"text":"%angular\n<div class=\"col-sm-12 form-group\">\n<div class=\"col-sm-4\"> <label class=\"\" for=\"selectYear\">Choose a year to view data on pie chart </label></div>\n<div class=\"col-sm-8\"> <select class=\"form-control\" id=\"selectYear\" ng-model=\"year\" ng-options=\"y as y for y in inputYear\"></select> </div>\n</div>\n<div><center><h2>Year {{year}}</h2></center></div>","dateUpdated":"Mar 22, 2016 4:58:10 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458622194018_953830488","id":"20160322-044954_1351761532","result":{"code":"SUCCESS","type":"ANGULAR","msg":"<div class=\"col-sm-12 form-group\">\n<div class=\"col-sm-4\"> <label class=\"\" for=\"selectYear\">Choose a year to view data on pie chart </label></div>\n<div class=\"col-sm-8\"> <select class=\"form-control\" id=\"selectYear\" ng-model=\"year\" ng-options=\"y as y for y in inputYear\"></select> </div>\n</div>\n<div><center><h2>Year {{year}}</h2></center></div>"},"dateCreated":"Mar 22, 2016 4:49:54 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:27","dateFinished":"Mar 22, 2016 4:58:10 AM","dateStarted":"Mar 22, 2016 4:58:10 AM","focus":true},{"text":"val temp1 = sqlContext.sql(\"select sum(game) game, sum(golf) golf, sum(tour) tour, sum(karaoke) karaoke, sum(billard) billard, sum(hospital) hospital, sum(video) video, sum(entertainment) entertainment, sum(restaurant) restaurant, sum(press) press, sum(orientalclinic) orientalclinic, sum(gym) gym, year from countryData where  year = \"+ z.angular(\"year\") + \" and 1=1 group by year\").collect()\nvar tableTemp: String = \"1sector_name\\tsector_value\\tyear\\n\"\nfor(i <- 0 until temp1.length){\n    tableTemp += \"game\\t\" +  temp1(i)(0) + \"\\t\" + temp1(i)(12) + \"\\ngolf\\t\" + temp1(i)(1) + \"\\t\" + temp1(i)(12) + \"\\ntour\\t\" + temp1(i)(2) + \"\\t\" + temp1(i)(12) + \"\\nkaraoke\\t\" + temp1(i)(3) + \"\\t\" + temp1(i)(12) + \"\\nbillard\\t\" + temp1(i)(4) + \"\\t\" + temp1(i)(12) + \"\\nhospital\\t\" + temp1(i)(5) + \"\\t\" + temp1(i)(12) + \"\\nvideo\\t\" + temp1(i)(6) + \"\\t\" + temp1(i)(12) + \"\\nentertainment\\t\" + temp1(i)(7) + \"\\t\" + temp1(i)(12)  +\"\\npress\\t\" + temp1(i)(9) + \"\\t\" + temp1(i)(12) + \"\\norientalclinic\\t\" + temp1(i)(10) + \"\\t\" + temp1(i)(12) + \"\\ngym\\t\" + temp1(i)(11) + \"\\t\" + temp1(i)(12)\n}\nprintln(s\"\"\"%table$tableTemp\"\"\")","dateUpdated":"Mar 22, 2016 4:49:54 AM","config":{"colWidth":12,"graph":{"mode":"pieChart","height":300,"optionOpen":false,"keys":[{"name":"sector_name","index":0,"aggr":"sum"}],"values":[{"name":"sector_value","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"sector_name","index":0,"aggr":"sum"},"yAxis":{"name":"sector_value","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458622194018_953830488","id":"20160322-044954_686870527","result":{"code":"SUCCESS","type":"TABLE","msg":"sector_name\tsector_value\tyear\ngame\t115499\t2003\ngolf\t13271\t2003\ntour\t32979\t2003\nkaraoke\t62054\t2003\nbillard\t53684\t2003\nhospital\t93844\t2003\nvideo\t8765\t2003\nentertainment\t146322\t2003\npress\t46185\t2003\norientalclinic\t876\t2003\ngym\t20452\t2003\n","comment":"","msgTable":[[{"key":"sector_value","value":"game"},{"key":"sector_value","value":"115499"},{"key":"sector_value","value":"2003"}],[{"key":"year","value":"golf"},{"key":"year","value":"13271"},{"key":"year","value":"2003"}],[{"value":"tour"},{"value":"32979"},{"value":"2003"}],[{"value":"karaoke"},{"value":"62054"},{"value":"2003"}],[{"value":"billard"},{"value":"53684"},{"value":"2003"}],[{"value":"hospital"},{"value":"93844"},{"value":"2003"}],[{"value":"video"},{"value":"8765"},{"value":"2003"}],[{"value":"entertainment"},{"value":"146322"},{"value":"2003"}],[{"value":"press"},{"value":"46185"},{"value":"2003"}],[{"value":"orientalclinic"},{"value":"876"},{"value":"2003"}],[{"value":"gym"},{"value":"20452"},{"value":"2003"}]],"columnNames":[{"name":"sector_name","index":0,"aggr":"sum"},{"name":"sector_value","index":1,"aggr":"sum"},{"name":"year","index":2,"aggr":"sum"}],"rows":[["game","115499","2003"],["golf","13271","2003"],["tour","32979","2003"],["karaoke","62054","2003"],["billard","53684","2003"],["hospital","93844","2003"],["video","8765","2003"],["entertainment","146322","2003"],["press","46185","2003"],["orientalclinic","876","2003"],["gym","20452","2003"]]},"dateCreated":"Mar 22, 2016 4:49:54 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:28","dateFinished":"Mar 22, 2016 4:58:15 AM","dateStarted":"Mar 22, 2016 4:58:13 AM"},{"dateUpdated":"Mar 22, 2016 4:49:54 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458622194018_953830488","id":"20160322-044954_182952396","dateCreated":"Mar 22, 2016 4:49:54 AM","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:29"}],"name":"Visualization v1.0","id":"2BEYAE7KB","angularObjects":{"2BH48TPDP":[],"2BG1MP4VE":[],"2BE7QY8J2":[],"2BH7RKBS2":[],"2BH7T35EH":[],"2BFAVPQR3":[],"2BH5AU4HU":[],"2BHCRYF9J":[],"2BFPBFG6U":[],"2BG4FK4ZV":[],"2BF7Q62UY":[],"2BH8D8F5Q":[],"2BH7RZHQ9":[],"2BFRXUZH8":[]},"config":{"looknfeel":"default"},"info":{}}