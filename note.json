{"paragraphs":[{"text":"val countryDataText = sc.textFile(\"/home/app/data/national_count_data.csv\")\r\n\r\ncase class CountryData(year: Integer, month: Integer, game:Integer, golf : Integer, tour : Integer, karaoke : Integer, billard : Integer, hospital : Integer, video : Integer, entertainment: Integer, restaurant: Integer, press: Integer, orientalclinic: Integer, gym: Integer, total: Integer)\r\n\r\n// split each line, and map it into CountryData case class  \r\nval countryData = countryDataText.map(s=>s.split(\",\")).map(\r\n    s=>CountryData(s(0).replaceAll(\"\\\"\", \"\").split(\"-\")(0).toInt, \r\n            s(0).replaceAll(\"\\\"\", \"\").split(\"-\")(1).toInt, \r\n            s(1).toInt,\r\n            s(2).toInt,\r\n            s(3).toInt,\r\n            s(4).toInt,\r\n            s(5).toInt,\r\n            s(6).toInt,\r\n            s(7).toInt,\r\n            s(8).toInt,\r\n            s(9).toInt,\r\n            s(10).toInt,\r\n            s(11).toInt,\r\n            s(12).toInt,\r\n            s(13).toInt\r\n        )\r\n)\r\n\r\n// convert to DataFrame and create temporal table\r\nval countryDataDF = countryData.toDF()\r\ncountryDataDF.show()\r\ncountryDataDF.registerTempTable(\"countryData\")","dateUpdated":"Mar 23, 2016 12:49:21 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","lineNumbers":true,"tableHide":true,"editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458622194014_967681449","id":"20160322-044954_741052678","result":{"code":"SUCCESS","type":"TEXT","msg":"countryDataText: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[24] at textFile at <console>:29\ndefined class CountryData\ncountryData: org.apache.spark.rdd.RDD[CountryData] = MapPartitionsRDD[26] at map at <console>:35\ncountryDataDF: org.apache.spark.sql.DataFrame = [year: int, month: int, game: int, golf: int, tour: int, karaoke: int, billard: int, hospital: int, video: int, entertainment: int, restaurant: int, press: int, orientalclinic: int, gym: int, total: int]\n+----+-----+----+----+----+-------+-------+--------+-----+-------------+----------+-----+--------------+---+------+\n|year|month|game|golf|tour|karaoke|billard|hospital|video|entertainment|restaurant|press|orientalclinic|gym| total|\n+----+-----+----+----+----+-------+-------+--------+-----+-------------+----------+-----+--------------+---+------+\n|2000|    1| 302|  17|  44|    105|    123|     143|   15|          340|      4974|  107|             2| 32|  6204|\n|2000|    2| 628|  37|  96|    181|    239|     300|   22|          658|     10428|  196|             5| 69| 12859|\n|2000|    3|1049|  52| 185|    296|    392|     501|   40|         1044|     17723|  286|             7|114| 21689|\n|2000|    4|1341|  79| 234|    385|    536|     712|   49|         1318|     23171|  361|            12|135| 28333|\n|2000|    5|1628|  92| 280|    494|    640|     867|   56|         1630|     28926|  444|            15|170| 35242|\n|2000|    6|1855| 102| 343|    565|    721|    1002|   63|         1999|     34451|  524|            19|199| 41843|\n|2000|    7|2059| 114| 384|    651|    819|    1110|   78|         2322|     39486|  615|            20|230| 47888|\n|2000|    8|2268| 130| 433|    733|    895|    1210|   85|         2596|     44545|  686|            20|253| 53854|\n|2000|    9|2425| 139| 480|    796|    951|    1325|   98|         2864|     49009|  750|            21|280| 59138|\n|2000|   10|2548| 153| 537|    863|   1035|    1447|  119|         3158|     54830|  814|            21|321| 65846|\n|2000|   11|2674| 176| 588|    949|   1090|    1579|  134|         3494|     60556|  882|            21|352| 72495|\n|2000|   12|2761| 197| 645|   1088|   1142|    1725|  146|         3918|     66089|  953|            21|378| 79063|\n|2001|    1|2848| 216| 702|   1146|   1193|    1877|  159|         4157|     68928| 1026|            22|401| 82675|\n|2001|    2|2963| 235| 739|   1236|   1287|    2078|  168|         4387|     73210| 1121|            22|439| 87885|\n|2001|    3|3136| 253| 793|   1350|   1404|    2334|  179|         4700|     79430| 1210|            23|482| 95294|\n|2001|    4|3274| 274| 856|   1452|   1501|    2601|  199|         5010|     85976| 1314|            26|516|102999|\n|2001|    5|3342| 290| 934|   1566|   1595|    2818|  215|         5314|     92740| 1406|            27|559|110806|\n|2001|    6|3420| 308| 996|   1674|   1690|    2997|  235|         5670|     99366| 1492|            28|601|118477|\n|2001|    7|3482| 332|1062|   1769|   1764|    3152|  257|         6007|    105566| 1564|            28|648|125631|\n|2001|    8|3509| 365|1134|   1867|   1811|    3343|  291|         6325|    111566| 1642|            31|677|132561|\n+----+-----+----+----+----+-------+-------+--------+-----+-------------+----------+-----+--------------+---+------+\nonly showing top 20 rows\n\n"},"dateCreated":"Mar 22, 2016 4:49:54 AM","dateStarted":"Mar 22, 2016 6:25:41 AM","dateFinished":"Mar 22, 2016 6:25:42 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:52"},{"text":"%sql select year, sum(${3sector=total,total|game|golf|tour|karaoke|billard|hospital|video|entertainment|restaurant|press|orientalclinic|gym}) NumberOfCompanies from countryData where   year >= ${1minYear=2000} and year <= ${2maxYear=2014} group by year order by year","dateUpdated":"Mar 23, 2016 1:01:48 AM","config":{"colWidth":6,"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"year","index":0,"aggr":"sum"}],"values":[{"name":"NumberOfCompanies","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"year","index":0,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql","editorHide":true,"tableHide":false,"title":true},"settings":{"params":{"maxYear":"2014","sector":"game","1minYear":"2000","2maxYear":"2014","3sector":"billard"},"forms":{"3sector":{"name":"3sector","defaultValue":"total","options":[{"value":"total"},{"value":"game"},{"value":"golf"},{"value":"tour"},{"value":"karaoke"},{"value":"billard"},{"value":"hospital"},{"value":"video"},{"value":"entertainment"},{"value":"restaurant"},{"value":"press"},{"value":"orientalclinic"},{"value":"gym"}],"hidden":false},"2maxYear":{"name":"2maxYear","defaultValue":"2014","hidden":false},"1minYear":{"name":"1minYear","defaultValue":"2000","hidden":false}}},"jobName":"paragraph_1458622194017_952676242","id":"20160322-044954_725158312","result":{"code":"SUCCESS","type":"TABLE","msg":"year\tNumberOfCompanies\n2000\t8583\n2001\t20190\n2002\t33318\n2003\t53684\n2004\t65774\n2005\t72783\n2006\t76647\n2007\t88271\n2008\t113834\n2009\t146738\n2010\t162605\n2011\t165389\n2012\t162365\n2013\t156050\n2014\t150379\n","comment":"","msgTable":[[{"key":"NumberOfCompanies","value":"2000"},{"key":"NumberOfCompanies","value":"8583"}],[{"value":"2001"},{"value":"20190"}],[{"value":"2002"},{"value":"33318"}],[{"value":"2003"},{"value":"53684"}],[{"value":"2004"},{"value":"65774"}],[{"value":"2005"},{"value":"72783"}],[{"value":"2006"},{"value":"76647"}],[{"value":"2007"},{"value":"88271"}],[{"value":"2008"},{"value":"113834"}],[{"value":"2009"},{"value":"146738"}],[{"value":"2010"},{"value":"162605"}],[{"value":"2011"},{"value":"165389"}],[{"value":"2012"},{"value":"162365"}],[{"value":"2013"},{"value":"156050"}],[{"value":"2014"},{"value":"150379"}]],"columnNames":[{"name":"year","index":0,"aggr":"sum"},{"name":"NumberOfCompanies","index":1,"aggr":"sum"}],"rows":[["2000","8583"],["2001","20190"],["2002","33318"],["2003","53684"],["2004","65774"],["2005","72783"],["2006","76647"],["2007","88271"],["2008","113834"],["2009","146738"],["2010","162605"],["2011","165389"],["2012","162365"],["2013","156050"],["2014","150379"]]},"dateCreated":"Mar 22, 2016 4:49:54 AM","dateStarted":"Mar 22, 2016 11:59:21 PM","dateFinished":"Mar 22, 2016 11:59:21 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53","title":"view sector by range of year"},{"text":"%sql select year, sum(${3compared_sector=total,total|game|golf|tour|karaoke|billard|hospital|video|entertainment|restaurant|press|orientalclinic|gym}) NumberOfCompanies from countryData where  year >= ${1minYear=2000} and year <= ${2maxYear=2014} group by year order by year","dateUpdated":"Mar 23, 2016 1:02:15 AM","config":{"colWidth":6,"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"year","index":0,"aggr":"sum"}],"values":[{"name":"NumberOfCompanies","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"year","index":0,"aggr":"sum"},"yAxis":{"name":"NumberOfCompanies","index":1,"aggr":"sum"}}},"enabled":true,"editorHide":true,"title":true},"settings":{"params":{"sector":"golf","1minYear":"2000","2maxYear":"2014","3sector":"game","3compared_sector":"tour"},"forms":{"3compared_sector":{"name":"3compared_sector","defaultValue":"total","options":[{"value":"total"},{"value":"game"},{"value":"golf"},{"value":"tour"},{"value":"karaoke"},{"value":"billard"},{"value":"hospital"},{"value":"video"},{"value":"entertainment"},{"value":"restaurant"},{"value":"press"},{"value":"orientalclinic"},{"value":"gym"}],"hidden":false},"2maxYear":{"name":"2maxYear","defaultValue":"2014","hidden":false},"1minYear":{"name":"1minYear","defaultValue":"2000","hidden":false}}},"jobName":"paragraph_1458622194017_952676242","id":"20160322-044954_1495971241","result":{"code":"SUCCESS","type":"TABLE","msg":"year\tNumberOfCompanies\n2000\t4249\n2001\t12448\n2002\t22377\n2003\t32979\n2004\t41221\n2005\t50491\n2006\t60993\n2007\t72149\n2008\t83791\n2009\t90415\n2010\t95317\n2011\t102628\n2012\t110099\n2013\t116437\n2014\t122739\n","comment":"","msgTable":[[{"key":"NumberOfCompanies","value":"2000"},{"key":"NumberOfCompanies","value":"4249"}],[{"value":"2001"},{"value":"12448"}],[{"value":"2002"},{"value":"22377"}],[{"value":"2003"},{"value":"32979"}],[{"value":"2004"},{"value":"41221"}],[{"value":"2005"},{"value":"50491"}],[{"value":"2006"},{"value":"60993"}],[{"value":"2007"},{"value":"72149"}],[{"value":"2008"},{"value":"83791"}],[{"value":"2009"},{"value":"90415"}],[{"value":"2010"},{"value":"95317"}],[{"value":"2011"},{"value":"102628"}],[{"value":"2012"},{"value":"110099"}],[{"value":"2013"},{"value":"116437"}],[{"value":"2014"},{"value":"122739"}]],"columnNames":[{"name":"year","index":0,"aggr":"sum"},{"name":"NumberOfCompanies","index":1,"aggr":"sum"}],"rows":[["2000","4249"],["2001","12448"],["2002","22377"],["2003","32979"],["2004","41221"],["2005","50491"],["2006","60993"],["2007","72149"],["2008","83791"],["2009","90415"],["2010","95317"],["2011","102628"],["2012","110099"],["2013","116437"],["2014","122739"]]},"dateCreated":"Mar 22, 2016 4:49:54 AM","dateStarted":"Mar 23, 2016 12:55:45 AM","dateFinished":"Mar 23, 2016 12:55:45 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:54","title":"view compared sector"},{"text":"%sql select month, year, sum(${2sector=total,total|game|golf|tour|karaoke|billard|hospital|video|entertainment|restaurant|press|orientalclinic|gym}) Sector, \nsum(${3compared_sector=total,total|game|golf|tour|karaoke|billard|hospital|video|entertainment|restaurant|press|orientalclinic|gym}) ComparedSector from countryData \nwhere  year <= ${1year=2014} and year >= ${1year=2014} and month >= 1 and month <= 12 group by month, year order by month","dateUpdated":"Mar 23, 2016 1:02:56 AM","config":{"colWidth":12,"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"month","index":0,"aggr":"sum"}],"values":[{"name":"Sector","index":2,"aggr":"sum"},{"name":"ComparedSector","index":3,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"month","index":0,"aggr":"sum"},"yAxis":{"name":"year","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql","editorHide":true,"tableHide":false,"title":true},"settings":{"params":{"year":"2000","sector":"game","1year":"2010","compare_sector":"tour","2sector":"game","3compare_sector":"golf","3compared_sector":"golf"},"forms":{"3compared_sector":{"name":"3compared_sector","defaultValue":"total","options":[{"value":"total"},{"value":"game"},{"value":"golf"},{"value":"tour"},{"value":"karaoke"},{"value":"billard"},{"value":"hospital"},{"value":"video"},{"value":"entertainment"},{"value":"restaurant"},{"value":"press"},{"value":"orientalclinic"},{"value":"gym"}],"hidden":false},"1year":{"name":"1year","defaultValue":"2014","hidden":false},"2sector":{"name":"2sector","defaultValue":"total","options":[{"value":"total"},{"value":"game"},{"value":"golf"},{"value":"tour"},{"value":"karaoke"},{"value":"billard"},{"value":"hospital"},{"value":"video"},{"value":"entertainment"},{"value":"restaurant"},{"value":"press"},{"value":"orientalclinic"},{"value":"gym"}],"hidden":false}}},"jobName":"paragraph_1458622194018_953830488","id":"20160322-044954_2104668218","result":{"code":"SUCCESS","type":"TABLE","msg":"month\tyear\tSector\tComparedSector\n1\t2010\t12858\t4937\n2\t2010\t12764\t4988\n3\t2010\t12705\t5074\n4\t2010\t12568\t5162\n5\t2010\t12409\t5248\n6\t2010\t12290\t5343\n7\t2010\t12232\t5427\n8\t2010\t12165\t5485\n9\t2010\t12113\t5521\n10\t2010\t12053\t5577\n11\t2010\t12027\t5664\n12\t2010\t11984\t5715\n","comment":"","msgTable":[[{"key":"year","value":"1"},{"key":"year","value":"2010"},{"key":"year","value":"12858"},{"key":"year","value":"4937"}],[{"key":"Sector","value":"2"},{"key":"Sector","value":"2010"},{"key":"Sector","value":"12764"},{"key":"Sector","value":"4988"}],[{"key":"ComparedSector","value":"3"},{"key":"ComparedSector","value":"2010"},{"key":"ComparedSector","value":"12705"},{"key":"ComparedSector","value":"5074"}],[{"value":"4"},{"value":"2010"},{"value":"12568"},{"value":"5162"}],[{"value":"5"},{"value":"2010"},{"value":"12409"},{"value":"5248"}],[{"value":"6"},{"value":"2010"},{"value":"12290"},{"value":"5343"}],[{"value":"7"},{"value":"2010"},{"value":"12232"},{"value":"5427"}],[{"value":"8"},{"value":"2010"},{"value":"12165"},{"value":"5485"}],[{"value":"9"},{"value":"2010"},{"value":"12113"},{"value":"5521"}],[{"value":"10"},{"value":"2010"},{"value":"12053"},{"value":"5577"}],[{"value":"11"},{"value":"2010"},{"value":"12027"},{"value":"5664"}],[{"value":"12"},{"value":"2010"},{"value":"11984"},{"value":"5715"}]],"columnNames":[{"name":"month","index":0,"aggr":"sum"},{"name":"year","index":1,"aggr":"sum"},{"name":"Sector","index":2,"aggr":"sum"},{"name":"ComparedSector","index":3,"aggr":"sum"}],"rows":[["1","2010","12858","4937"],["2","2010","12764","4988"],["3","2010","12705","5074"],["4","2010","12568","5162"],["5","2010","12409","5248"],["6","2010","12290","5343"],["7","2010","12232","5427"],["8","2010","12165","5485"],["9","2010","12113","5521"],["10","2010","12053","5577"],["11","2010","12027","5664"],["12","2010","11984","5715"]]},"dateCreated":"Mar 22, 2016 4:49:54 AM","dateStarted":"Mar 22, 2016 6:26:01 AM","dateFinished":"Mar 22, 2016 6:26:02 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:55","title":"compare sectors by 12 month in a year"},{"text":"%sql select sum(game) game, sum(golf) golf, sum(tour) tour, sum(karaoke) karaoke, sum(billard) billard, sum(hospital) hospital, sum(video) video, \nsum(entertainment) entertainment, sum(restaurant) restaurant, sum(press) press, sum(orientalclinic) orientalclinic, sum(gym) gym, year\nfrom countryData where  year = ${year=2014} and 1=1 group by year, month","dateUpdated":"Mar 23, 2016 1:03:37 AM","config":{"colWidth":12,"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"year","index":12,"aggr":"sum"}],"values":[{"name":"game","index":0,"aggr":"sum"},{"name":"golf","index":1,"aggr":"sum"},{"name":"tour","index":2,"aggr":"sum"},{"name":"karaoke","index":3,"aggr":"sum"},{"name":"billard","index":4,"aggr":"sum"},{"name":"hospital","index":5,"aggr":"sum"},{"name":"press","index":9,"aggr":"sum"},{"name":"orientalclinic","index":10,"aggr":"sum"},{"name":"gym","index":11,"aggr":"sum"},{"name":"entertainment","index":7,"aggr":"sum"},{"name":"video","index":6,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"game","index":0,"aggr":"sum"},"yAxis":{"name":"golf","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql","editorHide":true,"tableHide":false,"title":true},"settings":{"params":{"year":"2014"},"forms":{"year":{"name":"year","defaultValue":"2014","hidden":false}}},"jobName":"paragraph_1458622194018_953830488","id":"20160322-044954_1469440496","result":{"code":"SUCCESS","type":"TABLE","msg":"game\tgolf\ttour\tkaraoke\tbillard\thospital\tvideo\tentertainment\trestaurant\tpress\torientalclinic\tgym\tyear\n5014\t6863\t9954\t1283\t12721\t27787\t93\t19876\t396191\t2762\t337\t3546\t2014\n4807\t6852\t9994\t1230\t12681\t27871\t87\t19876\t397147\t2540\t339\t3562\t2014\n4584\t6874\t10060\t1167\t12622\t27989\t85\t19877\t399276\t2381\t343\t3577\t2014\n4023\t6879\t10133\t1107\t12587\t28135\t79\t19903\t401940\t2246\t349\t3611\t2014\n3735\t6894\t10174\t1054\t12560\t28226\t73\t19892\t403708\t2098\t349\t3642\t2014\n3320\t6898\t10211\t981\t12531\t28306\t64\t19866\t405751\t1979\t355\t3672\t2014\n3084\t6917\t10268\t924\t12490\t28384\t57\t19888\t408314\t1887\t356\t3702\t2014\n2761\t6914\t10299\t858\t12449\t28448\t49\t19883\t410065\t1769\t357\t3719\t2014\n2525\t6921\t10348\t774\t12456\t28523\t44\t19894\t412262\t1652\t360\t3752\t2014\n2338\t6928\t10393\t729\t12425\t28620\t44\t19920\t415428\t1563\t359\t3788\t2014\n2132\t6928\t10443\t674\t12425\t28661\t39\t19935\t417333\t1438\t360\t3826\t2014\n1900\t6954\t10462\t598\t12432\t28694\t36\t19988\t419285\t1322\t361\t3865\t2014\n","comment":"","msgTable":[[{"key":"golf","value":"5014"},{"key":"golf","value":"6863"},{"key":"golf","value":"9954"},{"key":"golf","value":"1283"},{"key":"golf","value":"12721"},{"key":"golf","value":"27787"},{"key":"golf","value":"93"},{"key":"golf","value":"19876"},{"key":"golf","value":"396191"},{"key":"golf","value":"2762"},{"key":"golf","value":"337"},{"key":"golf","value":"3546"},{"key":"golf","value":"2014"}],[{"key":"tour","value":"4807"},{"key":"tour","value":"6852"},{"key":"tour","value":"9994"},{"key":"tour","value":"1230"},{"key":"tour","value":"12681"},{"key":"tour","value":"27871"},{"key":"tour","value":"87"},{"key":"tour","value":"19876"},{"key":"tour","value":"397147"},{"key":"tour","value":"2540"},{"key":"tour","value":"339"},{"key":"tour","value":"3562"},{"key":"tour","value":"2014"}],[{"key":"karaoke","value":"4584"},{"key":"karaoke","value":"6874"},{"key":"karaoke","value":"10060"},{"key":"karaoke","value":"1167"},{"key":"karaoke","value":"12622"},{"key":"karaoke","value":"27989"},{"key":"karaoke","value":"85"},{"key":"karaoke","value":"19877"},{"key":"karaoke","value":"399276"},{"key":"karaoke","value":"2381"},{"key":"karaoke","value":"343"},{"key":"karaoke","value":"3577"},{"key":"karaoke","value":"2014"}],[{"key":"billard","value":"4023"},{"key":"billard","value":"6879"},{"key":"billard","value":"10133"},{"key":"billard","value":"1107"},{"key":"billard","value":"12587"},{"key":"billard","value":"28135"},{"key":"billard","value":"79"},{"key":"billard","value":"19903"},{"key":"billard","value":"401940"},{"key":"billard","value":"2246"},{"key":"billard","value":"349"},{"key":"billard","value":"3611"},{"key":"billard","value":"2014"}],[{"key":"hospital","value":"3735"},{"key":"hospital","value":"6894"},{"key":"hospital","value":"10174"},{"key":"hospital","value":"1054"},{"key":"hospital","value":"12560"},{"key":"hospital","value":"28226"},{"key":"hospital","value":"73"},{"key":"hospital","value":"19892"},{"key":"hospital","value":"403708"},{"key":"hospital","value":"2098"},{"key":"hospital","value":"349"},{"key":"hospital","value":"3642"},{"key":"hospital","value":"2014"}],[{"key":"video","value":"3320"},{"key":"video","value":"6898"},{"key":"video","value":"10211"},{"key":"video","value":"981"},{"key":"video","value":"12531"},{"key":"video","value":"28306"},{"key":"video","value":"64"},{"key":"video","value":"19866"},{"key":"video","value":"405751"},{"key":"video","value":"1979"},{"key":"video","value":"355"},{"key":"video","value":"3672"},{"key":"video","value":"2014"}],[{"key":"entertainment","value":"3084"},{"key":"entertainment","value":"6917"},{"key":"entertainment","value":"10268"},{"key":"entertainment","value":"924"},{"key":"entertainment","value":"12490"},{"key":"entertainment","value":"28384"},{"key":"entertainment","value":"57"},{"key":"entertainment","value":"19888"},{"key":"entertainment","value":"408314"},{"key":"entertainment","value":"1887"},{"key":"entertainment","value":"356"},{"key":"entertainment","value":"3702"},{"key":"entertainment","value":"2014"}],[{"key":"restaurant","value":"2761"},{"key":"restaurant","value":"6914"},{"key":"restaurant","value":"10299"},{"key":"restaurant","value":"858"},{"key":"restaurant","value":"12449"},{"key":"restaurant","value":"28448"},{"key":"restaurant","value":"49"},{"key":"restaurant","value":"19883"},{"key":"restaurant","value":"410065"},{"key":"restaurant","value":"1769"},{"key":"restaurant","value":"357"},{"key":"restaurant","value":"3719"},{"key":"restaurant","value":"2014"}],[{"key":"press","value":"2525"},{"key":"press","value":"6921"},{"key":"press","value":"10348"},{"key":"press","value":"774"},{"key":"press","value":"12456"},{"key":"press","value":"28523"},{"key":"press","value":"44"},{"key":"press","value":"19894"},{"key":"press","value":"412262"},{"key":"press","value":"1652"},{"key":"press","value":"360"},{"key":"press","value":"3752"},{"key":"press","value":"2014"}],[{"key":"orientalclinic","value":"2338"},{"key":"orientalclinic","value":"6928"},{"key":"orientalclinic","value":"10393"},{"key":"orientalclinic","value":"729"},{"key":"orientalclinic","value":"12425"},{"key":"orientalclinic","value":"28620"},{"key":"orientalclinic","value":"44"},{"key":"orientalclinic","value":"19920"},{"key":"orientalclinic","value":"415428"},{"key":"orientalclinic","value":"1563"},{"key":"orientalclinic","value":"359"},{"key":"orientalclinic","value":"3788"},{"key":"orientalclinic","value":"2014"}],[{"key":"gym","value":"2132"},{"key":"gym","value":"6928"},{"key":"gym","value":"10443"},{"key":"gym","value":"674"},{"key":"gym","value":"12425"},{"key":"gym","value":"28661"},{"key":"gym","value":"39"},{"key":"gym","value":"19935"},{"key":"gym","value":"417333"},{"key":"gym","value":"1438"},{"key":"gym","value":"360"},{"key":"gym","value":"3826"},{"key":"gym","value":"2014"}],[{"key":"year","value":"1900"},{"key":"year","value":"6954"},{"key":"year","value":"10462"},{"key":"year","value":"598"},{"key":"year","value":"12432"},{"key":"year","value":"28694"},{"key":"year","value":"36"},{"key":"year","value":"19988"},{"key":"year","value":"419285"},{"key":"year","value":"1322"},{"key":"year","value":"361"},{"key":"year","value":"3865"},{"key":"year","value":"2014"}]],"columnNames":[{"name":"game","index":0,"aggr":"sum"},{"name":"golf","index":1,"aggr":"sum"},{"name":"tour","index":2,"aggr":"sum"},{"name":"karaoke","index":3,"aggr":"sum"},{"name":"billard","index":4,"aggr":"sum"},{"name":"hospital","index":5,"aggr":"sum"},{"name":"video","index":6,"aggr":"sum"},{"name":"entertainment","index":7,"aggr":"sum"},{"name":"restaurant","index":8,"aggr":"sum"},{"name":"press","index":9,"aggr":"sum"},{"name":"orientalclinic","index":10,"aggr":"sum"},{"name":"gym","index":11,"aggr":"sum"},{"name":"year","index":12,"aggr":"sum"}],"rows":[["5014","6863","9954","1283","12721","27787","93","19876","396191","2762","337","3546","2014"],["4807","6852","9994","1230","12681","27871","87","19876","397147","2540","339","3562","2014"],["4584","6874","10060","1167","12622","27989","85","19877","399276","2381","343","3577","2014"],["4023","6879","10133","1107","12587","28135","79","19903","401940","2246","349","3611","2014"],["3735","6894","10174","1054","12560","28226","73","19892","403708","2098","349","3642","2014"],["3320","6898","10211","981","12531","28306","64","19866","405751","1979","355","3672","2014"],["3084","6917","10268","924","12490","28384","57","19888","408314","1887","356","3702","2014"],["2761","6914","10299","858","12449","28448","49","19883","410065","1769","357","3719","2014"],["2525","6921","10348","774","12456","28523","44","19894","412262","1652","360","3752","2014"],["2338","6928","10393","729","12425","28620","44","19920","415428","1563","359","3788","2014"],["2132","6928","10443","674","12425","28661","39","19935","417333","1438","360","3826","2014"],["1900","6954","10462","598","12432","28694","36","19988","419285","1322","361","3865","2014"]]},"dateCreated":"Mar 22, 2016 4:49:54 AM","dateStarted":"Mar 22, 2016 6:26:06 AM","dateFinished":"Mar 22, 2016 6:26:07 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:56","title":"view distribution by sectors in a year"},{"text":"%sql select sum(game) game, sum(golf) golf, sum(tour) tour, sum(karaoke) karaoke, sum(billard) billard, sum(hospital) hospital, sum(video) video, \nsum(entertainment) entertainment, sum(restaurant) restaurant, sum(press) press, sum(orientalclinic) orientalclinic, sum(gym) gym, year, month\nfrom countryData where year = ${2year=2014} and month = ${1month=1} group by year, month","dateUpdated":"Mar 23, 2016 1:04:10 AM","config":{"colWidth":12,"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"keys":[{"name":"month","index":13,"aggr":"sum"}],"values":[{"name":"game","index":0,"aggr":"sum"},{"name":"golf","index":1,"aggr":"sum"},{"name":"tour","index":2,"aggr":"sum"},{"name":"karaoke","index":3,"aggr":"sum"},{"name":"billard","index":4,"aggr":"sum"},{"name":"hospital","index":5,"aggr":"sum"},{"name":"press","index":9,"aggr":"sum"},{"name":"orientalclinic","index":10,"aggr":"sum"},{"name":"gym","index":11,"aggr":"sum"},{"name":"entertainment","index":7,"aggr":"sum"},{"name":"video","index":6,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"game","index":0,"aggr":"sum"},"yAxis":{"name":"golf","index":1,"aggr":"sum"}}},"enabled":true,"editorHide":true,"tableHide":false,"editorMode":"ace/mode/sql","title":true},"settings":{"params":{"month":"3","year":"2010","1year":"2014","2month":"1","1month":"12","2year":"2014"},"forms":{"2year":{"name":"2year","defaultValue":"2014","hidden":false},"1month":{"name":"1month","defaultValue":"1","hidden":false}}},"jobName":"paragraph_1458622194018_953830488","id":"20160322-044954_872601315","result":{"code":"SUCCESS","type":"TABLE","msg":"game\tgolf\ttour\tkaraoke\tbillard\thospital\tvideo\tentertainment\trestaurant\tpress\torientalclinic\tgym\tyear\tmonth\n1900\t6954\t10462\t598\t12432\t28694\t36\t19988\t419285\t1322\t361\t3865\t2014\t12\n","comment":"","msgTable":[[{"key":"golf","value":"1900"},{"key":"golf","value":"6954"},{"key":"golf","value":"10462"},{"key":"golf","value":"598"},{"key":"golf","value":"12432"},{"key":"golf","value":"28694"},{"key":"golf","value":"36"},{"key":"golf","value":"19988"},{"key":"golf","value":"419285"},{"key":"golf","value":"1322"},{"key":"golf","value":"361"},{"key":"golf","value":"3865"},{"key":"golf","value":"2014"},{"key":"golf","value":"12"}]],"columnNames":[{"name":"game","index":0,"aggr":"sum"},{"name":"golf","index":1,"aggr":"sum"},{"name":"tour","index":2,"aggr":"sum"},{"name":"karaoke","index":3,"aggr":"sum"},{"name":"billard","index":4,"aggr":"sum"},{"name":"hospital","index":5,"aggr":"sum"},{"name":"video","index":6,"aggr":"sum"},{"name":"entertainment","index":7,"aggr":"sum"},{"name":"restaurant","index":8,"aggr":"sum"},{"name":"press","index":9,"aggr":"sum"},{"name":"orientalclinic","index":10,"aggr":"sum"},{"name":"gym","index":11,"aggr":"sum"},{"name":"year","index":12,"aggr":"sum"},{"name":"month","index":13,"aggr":"sum"}],"rows":[["1900","6954","10462","598","12432","28694","36","19988","419285","1322","361","3865","2014","12"]]},"dateCreated":"Mar 22, 2016 4:49:54 AM","dateStarted":"Mar 22, 2016 4:55:14 AM","dateFinished":"Mar 22, 2016 4:55:15 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:57","title":"view distribution by sectors in a month"},{"text":"val interpreterContext = z.getInterpreterContext()\nz.angularBind(\"inputYear\", Array(2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014))\nz.angularBind(\"year\", 2014)\nz.angularUnwatch(\"year\")\nz.angularWatch(\"year\", (before, after) => {\n    z.run(8, interpreterContext)\n})","dateUpdated":"Mar 23, 2016 12:50:08 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","editorHide":true,"tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458622194018_953830488","id":"20160322-044954_948550199","result":{"code":"SUCCESS","type":"TEXT","msg":"interpreterContext: org.apache.zeppelin.interpreter.InterpreterContext = org.apache.zeppelin.interpreter.InterpreterContext@24adac60\n"},"dateCreated":"Mar 22, 2016 4:49:54 AM","dateStarted":"Mar 22, 2016 6:26:15 AM","dateFinished":"Mar 22, 2016 6:26:15 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58"},{"text":"%angular\n<div class=\"col-sm-12 form-group\">\n<div class=\"col-sm-4\"> <label class=\"\" for=\"selectYear\">Choose a year to view data on pie chart </label></div>\n<div class=\"col-sm-8\"> <select class=\"form-control\" id=\"selectYear\" ng-model=\"year\" ng-options=\"y as y for y in inputYear\"></select> </div>\n</div>\n<div><center><h2>Year {{year}}</h2></center></div>","dateUpdated":"Mar 23, 2016 12:49:38 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458622194018_953830488","id":"20160322-044954_1351761532","result":{"code":"SUCCESS","type":"ANGULAR","msg":"<div class=\"col-sm-12 form-group\">\n<div class=\"col-sm-4\"> <label class=\"\" for=\"selectYear\">Choose a year to view data on pie chart </label></div>\n<div class=\"col-sm-8\"> <select class=\"form-control\" id=\"selectYear\" ng-model=\"year\" ng-options=\"y as y for y in inputYear\"></select> </div>\n</div>\n<div><center><h2>Year {{year}}</h2></center></div>"},"dateCreated":"Mar 22, 2016 4:49:54 AM","dateStarted":"Mar 22, 2016 6:26:18 AM","dateFinished":"Mar 22, 2016 6:26:18 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:59","focus":true},{"text":"val temp1 = sqlContext.sql(\"select sum(game) game, sum(golf) golf, sum(tour) tour, sum(karaoke) karaoke, sum(billard) billard, sum(hospital) hospital, sum(video) video, sum(entertainment) entertainment, sum(restaurant) restaurant, sum(press) press, sum(orientalclinic) orientalclinic, sum(gym) gym, year from countryData where  year = \"+ z.angular(\"year\") + \" and 1=1 group by year\").collect()\nvar tableTemp: String = \"1sector_name\\tsector_value\\tyear\\n\"\nfor(i <- 0 until temp1.length){\n    tableTemp += \"game\\t\" +  temp1(i)(0) + \"\\t\" + temp1(i)(12) + \"\\ngolf\\t\" + temp1(i)(1) + \"\\t\" + temp1(i)(12) + \"\\ntour\\t\" + temp1(i)(2) + \"\\t\" + temp1(i)(12) + \"\\nkaraoke\\t\" + temp1(i)(3) + \"\\t\" + temp1(i)(12) + \"\\nbillard\\t\" + temp1(i)(4) + \"\\t\" + temp1(i)(12) + \"\\nhospital\\t\" + temp1(i)(5) + \"\\t\" + temp1(i)(12) + \"\\nvideo\\t\" + temp1(i)(6) + \"\\t\" + temp1(i)(12) + \"\\nentertainment\\t\" + temp1(i)(7) + \"\\t\" + temp1(i)(12)  +\"\\npress\\t\" + temp1(i)(9) + \"\\t\" + temp1(i)(12) + \"\\norientalclinic\\t\" + temp1(i)(10) + \"\\t\" + temp1(i)(12) + \"\\ngym\\t\" + temp1(i)(11) + \"\\t\" + temp1(i)(12)\n}\nprintln(s\"\"\"%table$tableTemp\"\"\")","dateUpdated":"Mar 23, 2016 1:04:38 AM","config":{"colWidth":12,"graph":{"mode":"pieChart","height":300,"optionOpen":false,"keys":[{"name":"sector_name","index":0,"aggr":"sum"}],"values":[{"name":"sector_value","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"sector_name","index":0,"aggr":"sum"},"yAxis":{"name":"sector_value","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala","editorHide":true,"title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458622194018_953830488","id":"20160322-044954_686870527","result":{"code":"SUCCESS","type":"TABLE","msg":"sector_name\tsector_value\tyear\ngame\t105903\t2012\ngolf\t78256\t2012\ntour\t110099\t2012\nkaraoke\t31745\t2012\nbillard\t162365\t2012\nhospital\t310414\t2012\nvideo\t2209\t2012\nentertainment\t234152\t2012\npress\t52050\t2012\norientalclinic\t3761\t2012\ngym\t38211\t2012\n","comment":"","msgTable":[[{"key":"sector_value","value":"game"},{"key":"sector_value","value":"105903"},{"key":"sector_value","value":"2012"}],[{"key":"year","value":"golf"},{"key":"year","value":"78256"},{"key":"year","value":"2012"}],[{"value":"tour"},{"value":"110099"},{"value":"2012"}],[{"value":"karaoke"},{"value":"31745"},{"value":"2012"}],[{"value":"billard"},{"value":"162365"},{"value":"2012"}],[{"value":"hospital"},{"value":"310414"},{"value":"2012"}],[{"value":"video"},{"value":"2209"},{"value":"2012"}],[{"value":"entertainment"},{"value":"234152"},{"value":"2012"}],[{"value":"press"},{"value":"52050"},{"value":"2012"}],[{"value":"orientalclinic"},{"value":"3761"},{"value":"2012"}],[{"value":"gym"},{"value":"38211"},{"value":"2012"}]],"columnNames":[{"name":"sector_name","index":0,"aggr":"sum"},{"name":"sector_value","index":1,"aggr":"sum"},{"name":"year","index":2,"aggr":"sum"}],"rows":[["game","105903","2012"],["golf","78256","2012"],["tour","110099","2012"],["karaoke","31745","2012"],["billard","162365","2012"],["hospital","310414","2012"],["video","2209","2012"],["entertainment","234152","2012"],["press","52050","2012"],["orientalclinic","3761","2012"],["gym","38211","2012"]]},"dateCreated":"Mar 22, 2016 4:49:54 AM","dateStarted":"Mar 23, 2016 12:57:20 AM","dateFinished":"Mar 23, 2016 12:57:21 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:60","title":"distribution by sectors in pieChart"},{"dateUpdated":"Mar 22, 2016 4:49:54 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1458622194018_953830488","id":"20160322-044954_182952396","dateCreated":"Mar 22, 2016 4:49:54 AM","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:61"}],"name":"Visualization v1.0","id":"2BEYAE7KB","angularObjects":{"2BF8NE2P4":[],"2BET5R7F4":[],"2BHCB9UGH":[],"2BESSE15V":[],"2BGV3QE7D":[],"2BDRZK6KH":[],"2BH6HVJSY":[],"2BGN9RCJ6":[],"2BEQ2QJRC":[],"2BGCHUX6Y":[],"2BGWCVHC6":[],"2BE9KJ69A":[],"2BGRSEEPQ":[{"name":"year","object":2012,"noteId":"2BEYAE7KB"},{"name":"inputYear","object":[2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014],"noteId":"2BEYAE7KB"}],"2BFNSVG9Z":[]},"config":{"looknfeel":"default"},"info":{}}